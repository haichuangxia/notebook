## 1. 一次一密密码
1. 加密过程

   $$
   \begin{align}
   & 明文：x=x_0 x_1 x_2 \\
   & 密钥：k=k_0k_1k_2\\
   & 密文：y=y_0y_1y_2 \\
   & 加密函数：y_i=x_i+k_i(mod26) \\
   & 解密函数：x_i=y_i-k_i(mod26) \\
   & 注：密钥为随机产生的，而且只使用一次
   \end{align}
   $$

2. 特点
   1. 特点
      1. 密钥**使用随机数序列,并且只能用一次**
   2. 优点
      1. 密码随机产生,只可使用一次
      2. 无条件安全
      3. 加密和解密算法为加法运算,效率高
   3. 缺点
      1. 密钥长度和明文一样长,难以共享,不实用


# 2. 流密码的基本思想和结构
- 有记忆性，依靠有限状态机产生密钥流，其密钥流由密钥流发生函数，密钥k和指定的初态$\sigma_i$完全决定。

- 流密码的基本结构为：

<div align=center>
</div>

## 基本概念和思想
### 1. 基本概念

明文逐字符或逐比特加密,也叫做**序列密码(Sequence Cipher)**.由于其逐个加密的特点,特别适合**基于硬件**实现.

### 2. 基本思想
##### 1. 加密过程
基于密钥**K**创建一个**密码流**$z=z_0z_1z_2...$,使用**密码流**对明文串$x=x_1x_2...$进行加密,则密文**y**为:
$$
\begin{align}
& x=x=x_1x_2\dots \\
& 则由密钥流发生器f产生密钥流z_i=f(k,\sigma_i) \\
& z=z_0z_1z_2\dots \\
& 则y=y_0y_1y_2...=(Ez_0(x_0))(Ez_1(x_1))(Ez_2(x_2))\dots \\
\end{align}
$$

##### 2. 密钥流的产生
密钥流在**密钥流发生器**中发生,其数学表达为:
$$
\begin{align}
&令k为密钥,\sigma_i为加密器中记忆元件在i时刻的状态,\\

& f为由k和\sigma_i决定产生的密钥流发生器函数 \\
& z_i=f(k,\sigma_i) \\

\end{align}
$$

参数说明：
| 参数       | 说明                                        |
| ---------- | ------------------------------------------- |
| f          | 密钥流发生器函数，该函数由k和$\sigma_i$产生 |
| $\sigma_i$ | 加密器记忆元件在i时刻的状态                 |
| k          | 密钥                                        |




## 流密码的种类
### 自同步流密码

加密器中存储单元的状态依赖于输入的明文字符。

### 同步流密码
**内部记忆元件**的状态$\sigma_i$独立于明文字符.

由于$z_i=f(k,\sigma_i)$与明文字符无关,因此密文字符$y_i=Ez_i(x_i)$也**不依赖于此前的明文字符**.

同步流密码的加密器可以分为**密钥流产生器**和**加密变换器**两个部分.

#### 体制模型

![同步流密码体制模型](https://qingbin.oss-cn-chengdu.aliyuncs.com/img/2022/20221018155556.png) 

### 自同步流密码

**内部记忆元件**的状态$\sigma_i$与明文字符有关

## 实现部件

以常见的同步流密码为例，其实现主要包括**密钥流产生器**和**加密变换器**两个部分。

其中，密钥流产生器是一个有限状态机，有限状态机的组成中包括**记忆元件**来记忆状态。

### 1. 记忆元件
**加密器**中的**记忆元件**由一组**移位寄存器**构成.其结构示意图为：


其主要的功能为：**记录有限状态机的状态**

### 2. 密钥流产生器
#### 结构组成与分解
密钥流产生器实质是一个**有限状态机**，该有限状态机的组成为：
| 成分             | 有限状态机的一般表示             | 密钥流产生器的表示                          |
| ---------------- | -------------------------------- | ------------------------------------------- |
| 有限状态集       | $S={s_i \| i=1,2,...,n}$         | 初始状态$\sigma_0$和状态集$\sum$            |
| 有限输入集       | $A_1={A_j ^{(1)}\| j=1,2,...,n}$ | 参数k（密钥）                               |
| 有限输出集       | $A_2={A_k ^{(1)}\| k=1,2,...,n}$ | 输出符号集Z                                 |
| 输出转移函数     | $A^{(2)}_k=f_1(s_i,A^{(1)}_j)$   | $\psi:\theta_i \rightarrow z_i$             |
| 次态状态转移函数 | $s_h=f_2(s_i,A^{(1)}_j)$         | $\varphi:\theta_i \rightarrow \theta_{i+1}$ |




参数选择为：
- 关键在于：找出适当的**状态转移函数φ**和**输出函数ψ**，使得输出序列z满足密钥流序列z应满足的随机性条件，并且要求在设备上是节省的和容易实现的。
- 一般采用**线性的φ**（状态转移函数）和**非线性的ψ**（输出函数），这样将能够进行深入的分析并可以得到好的生成器。（获得线性的状态转移，非线性的输出，保证随机性）

基于参数的不同功能，将密钥流生成器进行分解


#### 常见的两种密钥流生成器



## 常见的流密码体制
区别密码体制的标准,主要是**加密算法**和**密钥**
### 二元加法流密码体制
是一种使用$y_i=z_i \oplus x_i$的加密变换方法的密码体制,也是当前最常用的流密码体制.其示意图为:


# 密钥流的安全性-二元序列的伪随机性
安全的密钥流应该有良好的随机性，即随便获取一段，也没法推测后面的内容。但是在周期的密钥流中，要完全随机性非常困难，退而求其次，如果截取一段比周期短的一段密钥流不会泄露更多信息，这样的密钥流序列就叫做：**伪随机序列**

## 二元序列的相关概念
### 二元序列
GF(2)上的一个无限序列
### 游程
### 周期

# 补充知识点
## 1. 有限状态机
### 1. 有限状态机的基本组成 

### 

### 2. 有限状态机的表示
#### 1. 状态转移图
有限状态机可以使用**有向图**来表示，称之为**转移图**。有向图的**节点**是**状态**，**有向弧**由当前状态指向**下一状态**


#### 2. 有限状态机的矩阵表示


### 3. 有限状态机的实例

## GF(2)-有限域
## 2. 线性反馈移位寄存器