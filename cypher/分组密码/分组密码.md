# 基本概念

分组密码:将一段明文,切分成n段分组,对每段分组进行加密,而不是直接对全部明文进行加密.

## 代换

如果明文和密文的分组长都为n比特，则明文的每一个分组都有$2^n$个可能的取值。为使加密运算可逆（使解密运算可行），明文的每一个分组都应产生惟一的一个密文分组，这样的变换是***可逆***的，称明文分组到密文分组的可逆变换为***代换***。
•不同可逆变换的个数有$2^n!$个。

## SP网络

SP网络是基于下列两种最基本的密码运算：
•替代（Substitution ）
•置换（Permutation ）

### 代换

•代换是输入集A到输出A’上的双射变换：$f_k：A \rightarrow A＇$,式中，k在密码学中则为密钥。
•实现代换$f_K$的网络称作**代换网络**
•双射条件保证在给定k下可从密文惟一地恢复出原明文
•代换fk的集合：$S={f_k|k\in K}$
•如果网络可以实现所有可能的2n!个代换，则称其为全代换网络
•全代换网络密钥个数必须满足条件：＃{k}≥2n!

### 代换盒

在密码设计中，可选$n=r\times n_0$，其中*r*和$n_0$都为正整数，将设计n个变量的代换网络化为设计r个较小的子代换网络，而每个子代换网络只有$n_0$个输入变量。***称每个子代换网络为代换盒(SubstitutionBox)***

## Feistel密码

### 乘积密码

**乘积密码**:指顺序地执行两个或多个基本密码系统，使得最后结果的密码强度高于每个基本密码系统产生的结果.

整体大于部分之和的密码



# AES算法

AES算法的主要概念

| 概念 | 含义                                                         |
| ---- | ------------------------------------------------------------ |
| 密钥 | 密钥长度可以为128/192/256,但是子密钥的长度都是128位          |
| 填充 | AES是分组加密算法,分组长度为128位,如果一个分组长度小于128位,就需要填充成128位 |
| 模式 | 不同模式,明文加密成密文的过程不同                            |

几种填充方式:

| 填充方式           | 特点                                                         | Padding后的结果(明文:{1,2,3,4,5,a,b,c,d,e}) |
| ------------------ | ------------------------------------------------------------ | ------------------------------------------- |
| NoPadding          | 不做任何填充,要求明文mixup是16字节的整数倍                   |                                             |
| PKCS5Padding[默认] | 如果明文块少于16个字节（`128bit`），在明文块末尾补足相应数量的字符，且每个字节的值等于缺少的字符数 | {1,2,3,4,5,a,b,c,d,e,6,6,6,6,6,6 }          |
| ISO10126Padding    | 在明文块末尾补足相应数量的字节，最后一个字符值等于缺少的字符数，其他字符填充随机数 | {1,2,3,4,5,a,b,c,d,e,5,c,3,G,$,6}           |



模式

| 模式 | 特点                                                  |
| ---- | ----------------------------------------------------- |
| ECB  | 各组并行加密,相同内容的明文得到相同密文               |
| CGC  | 各组顺序加密,即便相同内容的明文,因为位置不同,密文不同 |
|      |                                                       |



## AES算法的运算过程

## AES算法的基本运算#结构

特点:

- 明文是128位的分组,密钥长度位是128/192/256

| 层            | 分层                | 作用                                                         |
| ------------- | ------------------- | ------------------------------------------------------------ |
| Add Round Key | 密钥加法层/轮密钥加 | 对明文矩阵和子密钥矩阵进行乘法操作$C=M×K_{sub}^T$            |
| SubByte       | 字节代换            | 使用S盒对上层的结果进行字节代换,解密的时候用逆S盒进行代换    |
| Shift Rows    | 行位移层            | 对上层的矩阵逐行进行移位操作                                 |
| Mix Column    | 列混淆层            | 对矩阵的每列进行扩散,使得输入的每个字节都会影响到4个输出字节 |

算法流程

1. 根据输入生成矩阵
![img](https://qingbin.oss-cn-chengdu.aliyuncs.com/img/2023/20230218191352.jpg)

2. 密钥加
![img](https://qingbin.oss-cn-chengdu.aliyuncs.com/img/2023/20230218191745.jpg)

3. 字节代换
![img](https://qingbin.oss-cn-chengdu.aliyuncs.com/img/2023/20230218191919.jpg)

4. 行移位
![img](https://qingbin.oss-cn-chengdu.aliyuncs.com/img/2023/20230218192123.jpg)

5. 列混淆
![img](https://qingbin.oss-cn-chengdu.aliyuncs.com/img/2023/20230218192804.jpg)

### AES子密钥生成

因为AES算法需要使用子密钥进行多轮的计算,因此需要根据用户输入的原始密钥生成子密钥.



### AES加密流程

![img](https://qingbin.oss-cn-chengdu.aliyuncs.com/img/2023/20230218193303.jpg)



### AES解密流程

![img](https://qingbin.oss-cn-chengdu.aliyuncs.com/img/2023/20230218193135.jpg)



## AES算法的模式

